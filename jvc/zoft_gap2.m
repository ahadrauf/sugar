function z=zoft_gap2(width,gap,t)
%z=zoft_gap2(2e-6,2e-6,-1e-10)/1e-6

p=width;
g=gap;
k=1+p/g;
a=-1+2*k^2+ 2*k*sqrt(k^2-1);
R=sqrt((t+1)/(t+a));
z1=g/pi*((a+1)/sqrt(a)*atanh(R)+(a-1)/sqrt(a)*R/(1-R^2)+log((R*sqrt(a)-1)/(R*sqrt(a)+1)));
%dzdt=0;%g*(1/2*(2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*(1/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-(t+1)/((t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))^2))/(sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*(1-(t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))))+1/2*(-2+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*(1/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-(t+1)/((t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))^2))/(sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*(1-(t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))))-(-2+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*(-1/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))+(t+1)/((t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))^2))/(sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*(1-(t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))^2)+(1/2*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*(1/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-(t+1)/((t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))^2))/(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))+1))-1/2*(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-1)*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*(1/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-(t+1)/((t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))^2))/((sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))+1)^2*sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))))*(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))+1)/(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-1))/pi;
%z2=g*((2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*atanh(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))))/(sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))+(-2+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))/(sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))*(1-(t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))))+log((sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))-1)/(sqrt((t+1)/(t-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1)))*sqrt(-1+2*(1+p/g)^2-2*(1+p/g)*sqrt((1+p/g)^2-1))+1)))/pi;
z=z1;

%R*sqrt(a)-1
%R=R
%sa=sqrt(a)
%Rsa=R*sa
%Rsa1=R*sqrt(a)-1
%'1-0.99999999999999999999535898384862245412943'
