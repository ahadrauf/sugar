%nonlinplot2

w0=1;
F=2;
k1=1;
m=1;
k3=0.2/m;
res=80;
lim=10;
W=0;A=0;
i=0;
for w=0:lim/res:lim
    a=1/3*((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)/k3  +  4/3*(-k1+m*w^2)/(((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3));
%    if isreal(a)
       i=i+1;
       W(i)=w;
       A(i)=real(a);
       %    end
end

figure(1);clf;
plot(W,A);grid on;hold on;

W=0;A=0;i=0;
I=sqrt(-1);
for w=0:lim/res:lim
    b=-1/6*((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)/k3-2/3*(-k1+m*w^2)/(((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3))+1/2*I*sqrt(3)*(1/3*((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)/k3-4/3*(-k1+m*w^2)/(((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)));
%    if isreal(b)
       i=i+1;
       W(i)=w;
       A(i)=real(b);
       %   end
end
plot(W,A,'r');

W=0;A=0;i=0;
I=sqrt(-1);
for w=0:lim/res:lim
    c=-1/6*((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)/k3-2/3*(-k1+m*w^2)/(((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3))-1/2*I*sqrt(3)*(1/3*((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)/k3-4/3*(-k1+m*w^2)/(((18*F+2*sqrt((16*k1^3-48*k1^2*m*w^2+48*k1*m^2*w^4-16*m^3*w^6+81*F^2*k3)/k3))*k3^2)^(1/3)));
%    if ~isreal(c)
       i=i+1;
       W(i)=w;
       A(i)=real(c);
       %   end
end
plot(W,A,'g');
