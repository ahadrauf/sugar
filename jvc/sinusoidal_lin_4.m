clear all
K=[  70,  -3,   0,   0;
     -3,   5,  -2,   2;
      0,  -2, 20,  -4;
      0,   2,  -4, 200];
M=[ 3,0,0,0;
    0,20,0,0;
    0,0,100,0;
    0,0,0,1];

D=.1*M;

F10=4.2336e-3*600;
F20=-4.42926e-3*600*0;
F30=3.3105e-3*600*0;
F=[F10;F20;F10;F20];

I=eye(4,4);
O=zeros(4,4);
A=[-M\D , -M\K; I, O];
B=[M\F;0;0;0;0];
C=[0,1,0,0,0,0,0,0];
D=[0;0;0;0];


j=sqrt(-1);
i=0;
for w=0:0.01:20
    i=i+1;
    s=j*w;
    H=C*inv(s*[I,O;O,I]-A)*B;
    y0=abs(H)*F10;
    Y0(i)=y0(1);
    theta(i)=real(H)\imag(H);
    W(i)=w;
end
figure(1);
hold on;
plot(W,Y0);
grid on;
