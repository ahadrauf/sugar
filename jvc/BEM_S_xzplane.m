function S=BEM_S_xzplane(x,y,a)

e0=8.854187817e-12; %permittivity of free space.

%S = -1/4*a*log(1/4*a^2-x*a+x^2+y^2) ...
%    + a ...
%    + 1/2*x*log(1/4*a^2-x*a+x^2+y^2) ...
%    + y*atan(1/2*(2*x-a)/(y+eps)) ...
%    - 1/4*a*log(1/4*a^2+x*a+x^2+y^2) ...
%    - 1/2*x*log(1/4*a^2+x*a+x^2+y^2) ...
%    - y*atan(1/2*(2*x+a)/(y+eps));
%S=S/2/pi/e0;

S =   (x-a/2) * log( sqrt((x-a/2)^2+y^2) ) ...
    - (x+a/2) * log( sqrt((x+a/2)^2+y^2) ) ...
    + y*atan((x-a/2)/(y+eps)) ...    
    - y*atan((x+a/2)/(y+eps)) ...
    + a;
S=S/2/pi/e0;
